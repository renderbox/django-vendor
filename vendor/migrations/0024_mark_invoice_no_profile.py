# Generated by Django 3.1.3 on 2021-05-31 02:54

from django.contrib.auth import get_user_model
from django.db import migrations

from vendor.config import DEFAULT_CURRENCY

User = get_user_model()


def fill_invoice_with_empty_profile(apps, schema_editor):
    # InvoiceModel = apps.get_model('vendor', 'Invoice')
    # CustomerProfileModel = apps.get_model('vendor', 'CustomerProfile')
    # first_user = User.objects.get(pk=1)

    # for invoice in InvoiceModel.objects.filter(profile__isnull=True):
    #     if not CustomerProfileModel.objects.filter(user=first_user, site=invoice.site).exists():
    #         profile = CustomerProfileModel.create(user=first_user,
    #                                               currency=DEFAULT_CURRENCY,
    #                                               site=invoice.site)
    #     else:
    #         profile = CustomerProfileModel.objects.get(user=first_user, site=invoice.site)

    #     invoice.profile = profile
    #     invoice.save()
    pass


class Migration(migrations.Migration):

    dependencies = [
        ('vendor', '0023_delete_profile_user_is_null'),
    ]

    operations = [
        migrations.RunPython(fill_invoice_with_empty_profile, reverse_code=migrations.RunPython.noop),
    ]
